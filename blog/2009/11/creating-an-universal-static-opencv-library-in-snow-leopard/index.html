


<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"  lang="it"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"  lang="it"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"  lang="it"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"  lang="it"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0;">
        <meta name="format-detection" content="telephone=no">

        <!-- <meta name="apple-mobile-web-app-capable" content="yes"> -->

        <meta name="author" content="Daniele Pizzoni">
        <meta name="description" content="Creating an universal static OpenCV library in (Snow) Leopard">
        <meta name="keywords" content="data.page.meta_keywords %>" />

            <title>Creating an universal static OpenCV library in (Snow) Leopard</title>

        <link href="/css/main-17afee39.css" rel="stylesheet" type="text/css" />
        <link href="/css/highlight-35741444.css" rel="stylesheet" type="text/css" />
        <link href="/css/print-d5585c86.css" rel="stylesheet" type="text/css" media="print" />

        <script src="/js/vendor/modernizr-2.6.1.min-68fdcc99.js" type="text/javascript"></script>
        <script src="/js/vendor/respond.min-bb760321.js" type="text/javascript"></script>

        <!-- <link href='/css/print-d5585c86.css' rel='stylesheet' type='text/css' media='print'> -->

        <link href='http://fonts.googleapis.com/css?family=Arvo:400,400italic' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>

        
    </head>

        	<body id="page" />


         <div class="masthead-shadow">
 <div class="container">
  <header id="masthead">

    <hr/>

    <nav id="menu">
      <ul>
        <li class="left"><a href="/">Chi sono</a></li>
        <li class="left"><a href="/portfolio/">Portfolio</a></li>
        <li class="right"><a href="/contatti/">Contatti</a></li>
        <li class="right"><a href="/blog/">Blog</a> | <a href="/faq/">FAQ</a></li>
      </ul>
    </nav>

    <div id="masthead-brand">
      <span class="masthead-logo" id="masthead-logo"><a href="/"><img src="/img/logo-b45c4748.png"/></a></span>
      <span class="masthead-logo" id="masthead-logo-2x"><a href="/"><img src="/img/logo@2x-d67070a7.png"/></a></span>
      
      <span class="menu-button" ><a href="#">
          <img id="menu-button-2x" src="/img/menu-icon@2x-ce9e5458.png"/>
          <img id="menu-button" src="/img/menu-icon-770ed078.png"/>
      </a></span>
      
    </div>

    <p id="motto">Daniele Pizzoni<span> &ndash; </span><br/>Artigiano del Software</p>

    <nav id="mobile-menu">
      <ul>
        <li class="left"><a href="/">Chi sono</a></li>
        <li class="left"><a href="/portfolio/">Portfolio</a></li>
        <li class="right"><a href="/blog/">Blog</a></li>
        <li class="right"><a href="/faq/">FAQ / Archivi</a></li>
        <li class="right"><a href="/contatti/">Contatti</a></li>
      </ul>
    </nav>
  </header>
</div>
</div>


            <div class="container" id="main-container" lang="en">

            <div id="main" role="page">

	<h1>Creating an universal static OpenCV library in (Snow) Leopard</h1>
	
	<p>More that a year ago i wrote a post about creating a fat OpenCV 1.0.0 static lib for OS X 10.5.</p>

<p>It seems it attracted some attention and it seems that some people found it useful. Unfortunately I have not been working directly with OpenCV for quite a lot of time, until recently, when I found myself in need of recompiling it for Snow Leopard.</p>

<p>So I created for myself a shell script that neatly compiles OpenCV 1.0.0 (download the source from <a href="http://sourceforge.net/projects/opencvlibrary/">Sourceforge</a>). It creates the libs for Leopard or Snow Leopard with i386, x86_64 and ppc architectures.</p>

<p>I have no time to contribute the iPhone part but if someone is willing to submit it I will add it to the script.</p>

<p>To use it first, unpack the OpenCV 1.0.0 sources in a folder, open a terminal window and cd to the folder you unpacked the sources: the &lsquo;ls&rsquo; command will list a &lsquo;opencv-1.0.0&rsquo; directory in it. Then select the text below and in the terminal launch the &lsquo;pico opencv-build-mac.sh&rsquo; command, paste the text, exit pico (with ctrl-x) and execute with &lsquo;bash opencv-build-mac.sh&rsquo;.</p>
<div class="highlight shell"><table style="border-spacing: 0"><tbody><tr><td class="gutter gl" style="text-align: right"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113</pre></td><td class="code"><pre><span class="c">#!/bin/bash</span>

<span class="c"># Download opencv-1.0.0.tar.gz from http://sourceforge.net/projects/opencvlibrary/</span>
<span class="c"># Unpack it in the same directory where this file resides.</span>
<span class="c"># Execute this file from a terminal with the command &amp;quot;bash opencv-build-mac.sh&amp;quot;</span>
<span class="c">#</span>
<span class="c"># Compiles for Leopard by default.</span>

<span class="c">#set -x</span>

<span class="nv">ROOTDIR</span><span class="o">=</span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>
<span class="nv">SRCDIR</span><span class="o">=</span>&amp;quot;<span class="k">${</span><span class="nv">ROOTDIR</span><span class="k">}</span>/opencv-1.0.0&amp;quot;

<span class="c"># Leopard</span>
<span class="nv">SYSROOT</span><span class="o">=</span>&amp;quot;-isysroot /Developer/SDKs/MacOSX10.5.sdk -mmacosx-version-min<span class="o">=</span>10.5&amp;quot;
<span class="nv">SUFFIX</span><span class="o">=</span>&amp;quot;-macosx10.5&amp;quot;

<span class="c"># Snow Leopard</span>
<span class="c">#SYSROOT=&amp;quot;-isysroot /Developer/SDKs/MacOSX10.6.sdk -mmacosx-version-min=10.6&amp;quot;</span>
<span class="c">#SUFFIX=&amp;quot;-macosx10.6&amp;quot;</span>

<span class="nv">I686DIR</span><span class="o">=</span>&amp;quot;<span class="nv">$ROOTDIR</span>/i686&amp;quot;
<span class="nv">PPCDIR</span><span class="o">=</span>&amp;quot;<span class="nv">$ROOTDIR</span>/ppc&amp;quot;
<span class="nv">X86_64DIR</span><span class="o">=</span>&amp;quot;<span class="nv">$ROOTDIR</span>/x86_64&amp;quot;

<span class="nv">CONFFLAGS</span><span class="o">=</span>&amp;quot;--without-imageio --without-python --without-swig --disable-apps
       --disable-dependency-tracking --without-carbon --without-quicktime
       --enable-shared<span class="o">=</span>no --without-gtk&amp;quot;

<span class="c">#</span>
<span class="c"># i686</span>
<span class="c">#</span>
build_i686<span class="o">()</span> <span class="o">{</span>

rm -rf <span class="nv">$I686DIR</span>
mkdir -p <span class="nv">$I686DIR</span>
<span class="nb">pushd</span> <span class="nv">$I686DIR</span>

<span class="k">${</span><span class="nv">SRCDIR</span><span class="k">}</span>/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> <span class="nv">CXXFLAGS</span><span class="o">=</span>&amp;quot;<span class="k">${</span><span class="nv">SYSROOT</span><span class="k">}</span> -arch i686&amp;quot; --target<span class="o">=</span>i686-apple-darwin10 <span class="o">||</span> <span class="nb">exit </span>1
make <span class="o">||</span> <span class="nb">exit </span>1
<span class="nb">popd</span>
<span class="o">}</span>

<span class="c">#</span>
<span class="c"># x86_64</span>
<span class="c">#</span>
build_x86_64 <span class="o">()</span> <span class="o">{</span>

rm -rf <span class="nv">$X86_64DIR</span>
mkdir -p <span class="nv">$X86_64DIR</span>
<span class="nb">pushd</span> <span class="nv">$X86_64DIR</span>

<span class="k">${</span><span class="nv">SRCDIR</span><span class="k">}</span>/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> <span class="nv">CXXFLAGS</span><span class="o">=</span>&amp;quot;<span class="k">${</span><span class="nv">SYSROOT</span><span class="k">}</span> -arch x86_64&amp;quot; --target<span class="o">=</span>x86_64-apple-darwin10 <span class="o">||</span> <span class="nb">exit </span>1
make <span class="o">||</span> <span class="nb">exit </span>1
<span class="nb">popd</span>
<span class="o">}</span>

<span class="c">#</span>
<span class="c"># ppc</span>
<span class="c">#</span>
build_ppc <span class="o">()</span> <span class="o">{</span>

rm -rf <span class="nv">$PPCDIR</span>
mkdir -p <span class="nv">$PPCDIR</span>
<span class="nb">pushd</span> <span class="nv">$PPCDIR</span>

<span class="k">${</span><span class="nv">SRCDIR</span><span class="k">}</span>/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> <span class="nv">CXXFLAGS</span><span class="o">=</span>&amp;quot;<span class="k">${</span><span class="nv">SYSROOT</span><span class="k">}</span> -arch ppc&amp;quot; --host<span class="o">=</span>i686-apple-darwin10 --target<span class="o">=</span>ppc-apple-darwin10 <span class="o">||</span> <span class="nb">exit </span>1
make <span class="o">||</span> <span class="nb">exit </span>1
<span class="nb">popd</span>
<span class="o">}</span>

<span class="c">#</span>
<span class="c"># creating fat lib</span>
<span class="c">#</span>
create_fat_lib<span class="o">()</span> <span class="o">{</span>

lipo -create <span class="nv">$I686DIR</span>/cv/src/.libs/libcv.a
         <span class="nv">$X86_64DIR</span>/cv/src/.libs/libcv.a
         <span class="nv">$PPCDIR</span>/cv/src/.libs/libcv.a
  -output libcv<span class="k">${</span><span class="nv">SUFFIX</span><span class="k">}</span>.a <span class="o">||</span> <span class="nb">exit </span>1

lipo -create <span class="nv">$I686DIR</span>/cxcore/src/.libs/libcxcore.a
         <span class="nv">$X86_64DIR</span>/cxcore/src/.libs/libcxcore.a
         <span class="nv">$PPCDIR</span>/cxcore/src/.libs/libcxcore.a
 -output libcxcore<span class="k">${</span><span class="nv">SUFFIX</span><span class="k">}</span>.a <span class="o">||</span> <span class="nb">exit </span>1

lipo -create <span class="nv">$I686DIR</span>/cvaux/src/.libs/libcvaux.a
         <span class="nv">$X86_64DIR</span>/cvaux/src/.libs/libcvaux.a
         <span class="nv">$PPCDIR</span>/cvaux/src/.libs/libcvaux.a
 -output libcvaux<span class="k">${</span><span class="nv">SUFFIX</span><span class="k">}</span>.a <span class="o">||</span> <span class="nb">exit </span>1

lipo -create <span class="nv">$I686DIR</span>/ml/src/.libs/libml.a
         <span class="nv">$X86_64DIR</span>/ml/src/.libs/libml.a
         <span class="nv">$PPCDIR</span>/ml/src/.libs/libml.a
 -output libml<span class="k">${</span><span class="nv">SUFFIX</span><span class="k">}</span>.a <span class="o">||</span> <span class="nb">exit </span>1

lipo -create <span class="nv">$I686DIR</span>/otherlibs/highgui/.libs/libhighgui.a
         <span class="nv">$X86_64DIR</span>/otherlibs/highgui/.libs/libhighgui.a
         <span class="nv">$PPCDIR</span>/otherlibs/highgui/.libs/libhighgui.a
 -output libhighgui<span class="k">${</span><span class="nv">SUFFIX</span><span class="k">}</span>.a <span class="o">||</span> <span class="nb">exit </span>1
<span class="o">}</span>

<span class="c">#</span>
<span class="c"># main</span>
<span class="c">#</span>

<span class="nb">cd</span> <span class="k">${</span><span class="nv">ROOTDIR</span><span class="k">}</span>
rm <span class="k">*</span>.a

build_i686
build_x86_64
build_ppc
create_fat_lib
</pre></td></tr></tbody></table>
</div>


	<footer class="article-footer">
		10 Nov 2009 
		| english
		| tecniche
	</footer>

	<nav id="page-nav">
		<span class="prev">
			<a href="/blog/2011/03/beatdelay/">Beat Delay</a>
		</span>

		<span class="next">
			<a href="/blog/2009/06/managing-static-versioned-libraries-in-os-x/">Managing static versioned libraries...</a>
		</span>
	</nav>


</div>


            <!--[if lt IE 9]>

    <div class="old-bro" style="">
    	Il tuo <i>browser</i> non permette la visualizzazione ottimale di questo sito.<br>
	    <a href="http://whatbrowser.org/">Scopri subito come aggiornarlo e perch√©.</a>
	</div>

<![endif]-->



            <footer id="main-footer">

<div id="footer-left">
	<p>Fatto a mano da:</p>
	<p>Daniele Pizzoni &mdash; Udine, Italy (EU)</p>
	<p>P.I. 02632010308</p>
</div>

<div id="footer-center">
	<p>Connect:</p>
	<p><a href="mailto:dan@danielepizzoni.it">email</a></p>
	<p><a href="http://twitter.com/ildan">twitter</a></p>
	<p><a href="http://it.linkedin.com/in/danielepizzoni/it">linkedin</a></p>
	<p><a href="http://stackoverflow.com/users/103529/ildan">stack overflow</a></p>

	
</div>

<div id="footer-right">
	<p>More:</p>
	<p><a href="/archivio-anno">archivio</a> </p>
	<p><a href="/archivio-tags">tags</a> </p>
	<p><a href="http://feeds.feedburner.com/danielepizzoni">rss</a></p>
</div>

<div id="credits">
	<p>Credits:
	<a href="http://middlemanapp.com">Middleman</a> 
	<a href="http://sass-lang.com">Sass</a>
	<a href="http://compass-style.org">Compass</a>
	<a href="http://susy.oddbird.net">Susy</a>
	<a href="http://daneden.me/baseline/">Baseline.js</a>
	<a href="http://www.google.com/webfonts">Google Web Fonts</a>
	<a href="http://subtlepatterns.com">Subtle Patterns</a>
	</p>
</div>
</footer>



            
        </div>

        

        

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.0.min.js"><\/script>')</script>

        <script src="/js/plugins-b0a9b306.js" type="text/javascript"></script>
        <script src="/js/main-bf7a3cf3.js" type="text/javascript"></script>

        <script>
        var _gaq=[['_setAccount','UA-21153020-1'],['_trackPageview']];
        (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>


    </body>
</html>
