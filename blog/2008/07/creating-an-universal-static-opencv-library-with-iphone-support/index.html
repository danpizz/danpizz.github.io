<!DOCTYPE html>
<html lang="it">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Creating an universal static OpenCV library with iPhone support</title>
  <meta name="description" content="This post has been updated here. Sorry I have no time to upgrade the iPhone part, I hope someone will share this knowledge ;)">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://danielepizzoni.it/blog/2008/07/creating-an-universal-static-opencv-library-with-iphone-support/">
  <link rel="alternate" type="application/rss+xml" title="Daniele Pizzoni" href="/feed.xml">
  
  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-21153020-1', 'auto');
  ga('send', 'pageview');

</script>
  

  
</head>


  <body>

    <header class="site-header" role="banner">

  <div class="wrapper">
    
    
    <a class="site-title" href="/">Daniele Pizzoni</a>
  
    
      <nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
              <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
              <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          
            
            
            <a class="page-link" href="/blog/">Blog</a>
            
          
            
            
            <a class="page-link" href="/contatti/">Contatti</a>
            
          
        </div>
      </nav>
    
  </div>
</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Creating an universal static OpenCV library with iPhone support</h1>
    <p class="post-meta">
      <time datetime="2008-07-03T00:00:00+02:00" itemprop="datePublished">
        
        Jul 3, 2008
      </time>
      </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>This post has been updated here. Sorry I have no time to upgrade the iPhone part, I hope someone will share this knowledge ;)</p>

<p>We will create a minimal static universal OpenCV 1.0.0 library with 4 architectures: Intel, PowerPC, x86_64 and Arm for the iPhone. I’ve been testing it on Leopard and Snow Leopard but it should work on any Mac OS X version.</p>

<p>First checkout or untar the OpenCV sources in the opencv-1.0.0 directory. Then, on the same level (not inside) create a build directory with 4 subdirectories: ppc, i386, x86_64 and arm. (Download the code from Sourceforge)</p>

<p>Then set the global configure settings:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span><span class="nb">export </span><span class="nv">CONFFLAGS</span><span class="o">=</span><span class="s2">"--without-imageio --without-python --without-swig
--disable-apps --disable-dependency-tracking --without-carbon
--without-quicktime --enable-shared=no --without-gtk"</span>
</code></pre>
</div>

<p>in the ppc dir:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>../../opencv-1.0.0/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> --target<span class="o">=</span>ppc-apple-darwin9
<span class="gp">$ </span>make <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-arch ppc"</span>
</code></pre>
</div>

<p>in the i386 dir:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>../../opencv-1.0.0/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> --target<span class="o">=</span>i386-apple-darwin9
<span class="gp">$ </span>make <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-arch i386"</span>
</code></pre>
</div>

<p>in the x86_64 dir:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>../../opencv-1.0.0/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> --target<span class="o">=</span>x86_64-apple-darwin9
<span class="gp">$ </span>make <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-arch x86_64"</span>
</code></pre>
</div>

<p>in the arm dir:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>../../opencv-1.0.0/configure <span class="k">${</span><span class="nv">CONFFLAGS</span><span class="k">}</span> --host <span class="o">=</span>arm-apple-darwin9 <span class="nv">CXX</span><span class="o">=</span>/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/arm-apple-darwin9-g++-4.2.1 <span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-arch armv6 -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk"</span> <span class="nv">CXXCPP</span><span class="o">=</span>/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/cpp
<span class="gp">$ </span>make
</code></pre>
</div>

<p>the last one is tough, so let’s see the variables one by one:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="nv">CXX</span><span class="o">=</span>/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/arm-apple-darwin9-g++-4.2.1
<span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">"-arch armv6 -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS3.0.sdk"</span>
<span class="nv">CXXCPP</span><span class="o">=</span>/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/cpp
</code></pre>
</div>

<p>Ok. Now for the universal static libs:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>lipo -create i386/cv/src/.libs/libcv.a x86_64/cv/src/.libs/libcv.a ppc/cv/src/.libs/libcv.a armv6/cv/src/.libs/libcv.a -output libcv.a
<span class="gp">$ </span>lipo -create i386/cxcore/src/.libs/libcxcore.a x86_64/cxcore/src/.libs/libcxcore.a ppc/cxcore/src/.libs/libcxcore.a armv6/cxcore/src/.libs/libcxcore.a -output libcxcore.a
<span class="gp">$ </span>lipo -create i386/cvaux/src/.libs/libcvaux.a x86_64/cvaux/src/.libs/libcvaux.a ppc/cvaux/src/.libs/libcvaux.a armv6/cvaux/src/.libs/libcvaux.a -output libcvaux.a
<span class="gp">$ </span>lipo -create i386/ml/src/.libs/libml.a x86_64/ml/src/.libs/libml.a ppc/ml/src/.libs/libml.a armv6/ml/src/.libs/libml.a -output libml.a
<span class="gp">$ </span>lipo -create i386/otherlibs/highgui/.libs/libhighgui.a x86_64/otherlibs/highgui/.libs/libhighgui.a ppc/otherlibs/highgui/.libs/libhighgui.a armv6/otherlibs/highgui/.libs/libhighgui.a -output libhighgui.a
</code></pre>
</div>

<p>That’s all. Oh, try</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>make -j 2
</code></pre>
</div>

  </div>

  
</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <!-- <h2 class="footer-heading">Daniele Pizzoni</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <!-- <li>
            
              Daniele Pizzoni
            
          </li> -->
          <li>
            Daniele Pizzoni - P.I. 02632010308
          </li>
            
          <li><a href="mailto:dan@danielepizzoni.it">dan@danielepizzoni.it</a></li>
            
          <li>
            <a href="/cookieprivacypolicy/">Privacy info</a>
          </li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">

          <li>
            <a href="https://www.linkedin.com/in/danielepizzoni/"><span class="icon icon--linkedin"><svg viewBox="0 0 16 16" width="16px" height="16px"><path d="M13.632 13.635h-2.37V9.922c0-.886-.018-2.025-1.234-2.025-1.235 0-1.424.964-1.424 1.96v3.778h-2.37V6H8.51v1.04h.03c.318-.6 1.092-1.233 2.247-1.233 2.4 0 2.845 1.58 2.845 3.637v4.188zM3.558 4.955c-.762 0-1.376-.617-1.376-1.377 0-.758.614-1.375 1.376-1.375.76 0 1.376.617 1.376 1.375 0 .76-.617 1.377-1.376 1.377zm1.188 8.68H2.37V6h2.376v7.635zM14.816 0H1.18C.528 0 0 .516 0 1.153v13.694C0 15.484.528 16 1.18 16h13.635c.652 0 1.185-.516 1.185-1.153V1.153C16 .516 15.467 0 14.815 0z" fill-rule="nonzero"/></svg>
</span><span class="username">danielepizzoni</span></a>

          </li>

          <li>
            <a href="https://stackoverflow.com/users/story/103529"><span class="icon icon--stackoverflow"><svg viewBox="0 0 16 16" width="16px" height="16px"><path d="M12.658 14.577v-4.27h1.423V16H1.23v-5.693h1.42v4.27h10.006zm-8.583-1.423h7.16V11.73h-7.16v1.424zm.173-3.235l6.987 1.46.3-1.38L4.55 8.54l-.302 1.38zm.906-3.37l6.47 3.02.602-1.3-6.47-3.02-.602 1.29zm1.81-3.19l5.478 4.57.906-1.08L7.87 2.28l-.9 1.078zM10.502 0L9.338.863l4.27 5.735 1.164-.862L10.5 0z"/></svg>
</span><span class="username">ildan</span></a>

          </li>

        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Artigiano del Software. Frontend and backend app developer.
</p>
      </div>
    </div>

  </div>


</footer>


  </body>

</html>
